<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>The HTML5 Herald</title>
  <meta name="description" content="Brian">
  <meta name="author" content="Steve Lee">

  <meta name="google-signin-client_id" content="565029808164-fnpc091ed2l5a03bhmq4apanav362a7h.apps.googleusercontent.com">

</head>

<body>
<p>Brian login test</p>

<div id="my-signin2" class="my-signin2"></div>
  
    <script>
    function onSuccess(googleUser) {
      var profile = googleUser.getBasicProfile();
      console.log('Logged in as: ' + profile.getName() + ' ' + profile.getEmail());
      var id_token = googleUser.getAuthResponse().id_token;
      console.log('token: ' + id_token);
    
      var gpreq = "https://picasaweb.google.com/data/feed/api/user/steve@opendirective.com?kind=album&access=visible&alt=json"
  
      var xhr = new XMLHttpRequest();
      xhr.open('get', gpreq);
    //xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
    xhr.onload = function() {
      console.log('Output: ' + xhr.responseText);
    };
    xhr.send();
      
    }
    function onFailure(error) {
      console.log('fail '+error);
    }
    function renderButton() {
      console.log('a');
      gapi.signin2.render('my-signin2', {
        'scope': 'profile email https://www.googleapis.com/auth/drive.photos.readonly',
        'width': 240,
        'height': 50,
        'longtitle': true,
        'theme': 'dark',
        'onsuccess': onSuccess,
        'onfailure': onFailure
      });
      console.log('b');
    }

  </script>

<a href="#" onclick="signOut();">Sign out</a>
<script>
  function signOut() {
    var auth2 = gapi.auth2.getAuthInstance();
    auth2.signOut().then(function () {
      console.log('User signed out.');
    });
  }
</script>

  <script src="https://apis.google.com/js/platform.js?onload=renderButton" async defer></script>
</body>
</html>
